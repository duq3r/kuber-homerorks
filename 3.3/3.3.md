# Домашнее задание к занятию "Как работает сеть в K8S"

### Цель задания

Настроить сетевую политику доступа к подам.

### Чеклист готовности к домашнему заданию

1. Кластер k8s с установленным сетевым плагином calico

### Инструменты и дополнительные материалы, которые пригодятся для выполнения задания

1. [Документация Calico](https://www.tigera.io/project-calico/)
2. [Network Policy](https://kubernetes.io/docs/concepts/services-networking/network-policies/)
3. [About Network Policy](https://docs.projectcalico.org/about/about-network-policy)

-----

### Задание 1. Создать сетевую политику (или несколько политик) для обеспечения доступа

1. Создать deployment'ы приложений frontend, backend и cache и соответсвующие сервисы.
2. В качестве образа использовать network-multitool.
3. Разместить поды в namespace app.
4. Создать политики чтобы обеспечить доступ frontend -> backend -> cache. Другие виды подключений должны быть запрещены.
5. Продемонстрировать, что трафик разрешен и запрещен.

## Ответ

Исходники
 - [Frontend](src/frontend.yaml)
 
 - [Backend](src/backend.yaml)

 - [Cache](src/cache.yaml)

Создаю namespace и deployment + service 
```
iworks@masterk8s:~$ kubectl create namespace app
namespace/app created
iworks@masterk8s:~$ kubectl apply -f frontend.yaml 
deployment.apps/frontend created
service/frontend created
iworks@masterk8s:~$ kubectl apply -f backend.yaml 
deployment.apps/backend created
service/backend created
iworks@masterk8s:~$ kubectl apply -f cache.yaml 
deployment.apps/cache created
service/cache created
iworks@masterk8s:~$ kubectl get deploy
No resources found in default namespace.
iworks@masterk8s:~$ kubectl get deploy -n app
NAME       READY   UP-TO-DATE   AVAILABLE   AGE
backend    1/1     1            1           20s
cache      1/1     1            1           13s
frontend   1/1     1            1           26s
```

Создаём политики по заданию 4. Фронтенд должен быть доступен, с него доступен бэк, а с бэка cache. 
 - [Front-to-back](src/np-frontend.yaml)

 - [Front-to-back](src/np-frontend.yaml)
 
 - [Backend](src/backend.yaml)

 - [Cache](src/cache.yaml)


### Правила приема работы

1. Домашняя работа оформляется в своем Git репозитории в файле README.md. Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.
2. Файл README.md должен содержать скриншоты вывода необходимых команд, а также скриншоты результатов
3. Репозиторий должен содержать тексты манифестов или ссылки на них в файле README.md
